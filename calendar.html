<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <title>Calendar</title>
    <meta name="mobile-web-app-capable" content="yes">
    <style>
        * {
            box-sizing: border-box;
        }
        html {
            font-size: 16px;
        }
        body {
            font-size: 1rem;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }
        html, body {
            height: 100%;
            padding: 0;
            margin: 0;
            background: #fff;
            color: #000;
        }
        .app {
            display: grid;
            grid-template-rows: min-content 1fr;
            grid-template-columns: 360px minmax(360px, 2fr);
            grid-template-areas: "toolbar toolbar" "options main";
            overflow: hidden;
            height: 100%;
            background: var(--app-panel-background);
            color: #000;
            position: relative;
            --app-spacing: .5rem;
            --app-panel-border: #ccc;
            --app-panel-border-radius: 4px;
            --app-panel-background: #eee;
            --app-panel-background-lighter: #f4f4f4;
            --app-content-background: #fff;
            --app-control-border: rgba(0, 0, 0, 0.25);
            --app-input-background: #fff;
            --app-input-color: #000;
            --app-button-background: #cdf;
            --app-button-background-hover: #abe;
            --app-button-background-active: #89e;
            --app-button-background-r: #fcc;
            --app-button-background-r-hover: #eaa;
            --app-button-background-r-active: #ed8787;
            --app-button-background-g: #d2ffcc;
            --app-button-background-g-hover: #b2eeaa;
            --app-button-background-g-active: #93ed87;
            --app-button-color: #000;
        }
        .app input,
        .app button {
            font: inherit;
            text-decoration: none;
            border-radius: var(--app-panel-border-radius);
            border: 1px solid var(--app-control-border);
            outline: none;
            margin: 0;
            padding: .25em;
        }
        .app input:disabled,
        .app button:disabled {
            opacity: 0.5;
        }
        .app input {
            background: var(--app-input-background);
            color: var(--app-input-color);
            min-width: 0;
        }
        .app button {
            background: var(--app-button-background);
            color: var(--app-button-color);
            min-width: 2em;
            text-align: center;
        }
        .app button.primary {
            --app-button-background: var(--app-button-background-g);
            --app-button-background-hover: var(--app-button-background-g-hover);
            --app-button-background-active: var(--app-button-background-g-active);
        }
        .app button.delete {
            --app-button-background: var(--app-button-background-r);
            --app-button-background-hover: var(--app-button-background-r-hover);
            --app-button-background-active: var(--app-button-background-r-active);
        }
        .app button:hover {
            background: var(--app-button-background-hover);
        }
        .app button:active {
            background: var(--app-button-background-active);
        }
        .app input:focus-visible,
        .app button:focus-visible {
            outline: 2px solid rgba(128, 128, 128, 0.15);
        }
        .app > * {
            min-width: 0;
        }
        .app > nav.toolbar {
            grid-area: toolbar;
            display: flex;
            padding: var(--app-spacing);
            gap: var(--app-spacing);
            line-height: 1;
            white-space: nowrap;
            align-items: stretch;
        }
        .app > nav.toolbar > * {
            height: 32px;
            min-width: 0;
        }
        .app > nav.toolbar > input[type="text"] {
            flex: 1;
            min-width: 0;
        }
        .app > nav.toolbar > button.options {
            display: none;
        }
        .app > aside.options {
            grid-area: options;
            display: flex;
            flex-direction: column;
            gap: var(--app-spacing);
            padding: 0 var(--app-spacing) var(--app-spacing);
            overflow-y: auto;
            font-size: .875em;
        }
        .app > aside.options > section {
            display: none;
            border: 1px solid var(--app-panel-border);
            background: var(--app-panel-background-lighter);
            border-radius: var(--app-panel-border-radius);
        }
        .app > aside.options > section .opt__name {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            min-width: 0;
            user-select: none;
        }
        .app > aside.options > section .opt__doc {
            font-size: 0.75em;
            opacity: 0.75;
            margin-top: .25em;
            user-select: none;
        }
        .app > aside.options > section.opt--flag,
        .app > aside.options > section.opt--filter {
            display: block;
        }
        .app > aside.options > section.opt--flag:hover {
            background: var(--app-panel-background);
        }
        .app > aside.options > section.opt--flag > label {
            display: flex;
            gap: var(--app-spacing);
            padding: var(--app-spacing);
            align-items: flex-start;
        }
        .app > aside.options > section.opt--flag > label > input {
            flex: 0 0 auto;
        }
        .app > aside.options > section.opt--flag > label > div {
            flex: 1;
            min-width: 0;
        }
        .app > aside.options > section.opt--flag .opt__doc {
            flex: 1;
        }
        .app > aside.options > section.opt--filter {
            display: block;
            padding: var(--app-spacing);
        }
        .app > aside.options > section.opt--filter .opt__item {
            display: flex;
            align-items: stretch;
            gap: .25em;
            margin-top: .25em;
        }
        .app > aside.options > section.opt--filter .opt__item > input {
            flex: 1;
        }
        .app > aside.options > section.opt--filter .opt__item > button {
            flex: 0 0 auto;
        }
        .app > main {
            grid-area: main;
            display: flex;
            flex-direction: column;
            gap: var(--app-spacing);
            padding: 0 var(--app-spacing) var(--app-spacing) 0;
        }
        .app > main > section {
            flex: 0 0 auto;
            border-radius: 4px;
            padding: var(--app-spacing);
            border: 1px solid var(--app-panel-border);
            background: var(--app-content-background);
        }
        .app > main > section.error {
            grid-area: error;
            border: 1px solid rgba(128, 0, 0, 0.5);
            background: rgba(128, 0, 0, 0.2);
            padding: var(--app-spacing);
            border-radius: var(--app-panel-border-radius);
        }
        .app > main > section.calendar {
            flex: 1;
            overflow: auto;
            font-size: .875em;
        }
        .app > main > section.calendar.fc {
            --fc-page-bg-color: var(--app-content-background);
            --fc-button-bg-color: var(--app-button-background);
            --fc-button-text-color: var(--app-button-color);
            --fc-button-hover-bg-color: var(--app-button-background-hover);
            --fc-button-active-bg-color: var(--app-button-background-active);
            --fc-button-border-color: var(--app-control-border);
            --fc-button-active-border-color: var(--app-control-border);
            --fc-button-hover-border-color: var(--app-control-border);
            --fc-list-event-hover-bg-color: transparent;
            --fc-border-color: rgba(0, 0, 0, 0.2);
            --fc-neutral-bg-color: rgb(238, 238, 238);
            --fc-event-bg-color: rgba(238, 238, 238, 0.8);
            --fc-event-text-color: #111;
            --fc-event-border-color: #ccc;
        }
        .app > main > section.calendar.fc .fc-event-main {
            overflow: hidden;
            text-overflow: ellipsis;
            font-size: .875em;
        }
        .app > main > section.calendar.fc .fc-header-toolbar {
            margin-bottom: var(--app-spacing);
        }
        .app > main > section.calendar.fc .fc-header-toolbar .fc-button {
            padding: 0.5em 0.75em;
            line-height: 1;
            font-size: inherit;
        }
        .app > main > section.calendar.fc .fc-header-toolbar .fc-button .fc-icon {
            font-size: inherit;
        }
        .app > main > section.calendar.fc .fc-header-toolbar .fc-button:focus:not(:focus-visible) {
            box-shadow: none;
            outline: none;
        }
        .app > div.subscribe {
            display: flex;
            align-items: center;
            justify-content: center;
            position: fixed;
            inset: 0;
            background: rgba(255, 255, 255, 0.80);
            backdrop-filter: blur(2px);
            font-size: .825em;
            z-index: 10000;
        }
        .app > div.subscribe > aside.inner {
            flex: 1;
            min-width: 0;
            max-width: 400px;
            min-height: 0;
            max-height: 100%;
            overflow: hidden auto;
            padding: .25em;
        }
        .app > div.subscribe > aside.inner > header {
            display: flex;
            align-items: flex-end;
            margin: .5em;
            user-select: none;
        }
        .app > div.subscribe > aside.inner > header > .title {
            flex: 1;
            font-size: 1.3em;
            font-weight: bold;
        }
        .app > div.subscribe > aside.inner > .sub {
            display: flex;
            flex-direction: column;
            align-items: stretch;
            background-color: var(--app-panel-background-lighter);
            border: 1px solid var(--app-panel-border);
            border-radius: var(--app-panel-border-radius);
            margin: .5em;
            padding: .5em;
            gap: .25em;
            user-select: none;
            text-decoration: none;
        }
        .app > div.subscribe > aside.inner > a.sub {
            background-color: var(--app-button-background);
            color: var(--app-button-color);
            border: 1px solid var(--app-control-border);
        }
        .app > div.subscribe > aside.inner > a.sub:hover {
            background-color: var(--app-button-background-hover);
        }
        .app > div.subscribe > aside.inner > a.sub:active {
            background-color: var(--app-button-background-active);
        }
        .app > div.subscribe > aside.inner > .sub > div.name {
            font-weight: 600;
            min-width: 0;
        }
        .app > div.subscribe > aside.inner > .sub > div.name > span {
            opacity: 0.5;
            min-width: 0;
        }
        .app > div.subscribe > aside.inner > .sub > div.desc {
            font-size: .825em;
        }
        .app > div.subscribe > aside.inner > .sub > input {
            background: rgba(128, 128, 128, 0.2);
            border: none !important;
            outline: 0 !important;
        }
        .app > div.subscribe > aside.inner > .sub {
            background-repeat: no-repeat;
            background-size: 32px 32px;
            background-position: 4px 50%;
        }
        .app > div.subscribe > aside.inner > .sub.sub--apple {
            padding-left: 40px;
            background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMCAzMCI+PHBhdGggZD0iTTI1LjU2NSA5Ljc4NWMtLjEyMy4wNzctMy4wNTEgMS43MDItMy4wNTEgNS4zMDUuMTM4IDQuMTA5IDMuNjk1IDUuNTUgMy43NTYgNS41NS0uMDYxLjA3Ny0uNTM3IDEuOTYzLTEuOTQ3IDMuOTQtMS4xMTkgMS43MDMtMi4zNjEgMy40Mi00LjI0NyAzLjQyLTEuNzk0IDAtMi40MzgtMS4xMzUtNC41MDgtMS4xMzUtMi4yMjMgMC0yLjg1MiAxLjEzNS00LjU1NCAxLjEzNS0xLjg4NiAwLTMuMjItMS44MDktNC40LTMuNDk2LTEuNTMzLTIuMjA4LTIuODM2LTUuNjczLTIuODgyLTktLjAzMS0xLjc2My4zMDctMy40OTYgMS4xNjUtNC45NjggMS4yMTEtMi4wNTUgMy4zNzMtMy40NSA1LjczNC0zLjQ5NiAxLjgwOS0uMDYxIDMuNDE5IDEuMjQyIDQuNTIzIDEuMjQyIDEuMDU4IDAgMy4wMzYtMS4yNDIgNS4yNzQtMS4yNDIuOTY2LjAwMSAzLjU0Mi4yOTIgNS4xMzcgMi43NDV6TTE1LjAwMSA2LjY4OGMtLjMyMi0xLjYxLjU2Ny0zLjIyIDEuMzk1LTQuMjQ3IDEuMDU4LTEuMjQyIDIuNzI5LTIuMDg1IDQuMTctMi4wODUuMDkyIDEuNjEtLjQ5MSAzLjE4OS0xLjUzMyA0LjMzOS0uOTM1IDEuMjQyLTIuNTQ1IDIuMTc3LTQuMDMyIDEuOTkzeiIvPjwvc3ZnPg==);
        }
        .app > div.subscribe > aside.inner > .sub.sub--outlook-work {
            padding-left: 40px;
            background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OCA0OCI+PGxpbmVhckdyYWRpZW50IGlkPSJhIiB4MT0iMzEuNjQ1IiB4Mj0iMzEuNjQ1IiB5MT0iNi44MzkiIHkyPSI0MC42MTUiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiNlNjhlMDAiLz48c3RvcCBvZmZzZXQ9Ii4wMzYiIHN0b3AtY29sb3I9IiNlMzg0MDAiLz48c3RvcCBvZmZzZXQ9Ii4xNzEiIHN0b3AtY29sb3I9IiNkYjYyMDAiLz48c3RvcCBvZmZzZXQ9Ii4yOTkiIHN0b3AtY29sb3I9IiNkNDRhMDAiLz48c3RvcCBvZmZzZXQ9Ii40MTciIHN0b3AtY29sb3I9IiNkMDNiMDAiLz48c3RvcCBvZmZzZXQ9Ii41MTUiIHN0b3AtY29sb3I9IiNjZjM2MDAiLz48c3RvcCBvZmZzZXQ9Ii44NzgiIHN0b3AtY29sb3I9IiNkMjI5MDAiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNkNDI0MDAiLz48L2xpbmVhckdyYWRpZW50PjxwYXRoIGZpbGw9InVybCgjYSkiIGQ9Ik0zNS44ODMgNy4zNDFDMzcuNzI2IDcuODUgMzkgOS41MDggMzkgMTEuMzk3djI1LjE2MmMwIDEuOTA2LTEuMzAxIDMuNTctMy4xNjggNC4wNjVMMjQuMjkgNDMuODYzIDI4IDM2VjExbC0zLjE0OC02Ljg4NSAxMS4wMzEgMy4yMjZ6Ii8+PGxpbmVhckdyYWRpZW50IGlkPSJiIiB4MT0iMTMuOTIyIiB4Mj0iMjkuMDUxIiB5MT0iMzQuOTUxIiB5Mj0iNDEuMDczIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjZjUyNTM3Ii8+PHN0b3Agb2Zmc2V0PSIuMjkzIiBzdG9wLWNvbG9yPSIjZjMyNTM2Ii8+PHN0b3Agb2Zmc2V0PSIuNDY1IiBzdG9wLWNvbG9yPSIjZWEyNDM0Ii8+PHN0b3Agb2Zmc2V0PSIuNjA1IiBzdG9wLWNvbG9yPSIjZGMyMjMxIi8+PHN0b3Agb2Zmc2V0PSIuNzI5IiBzdG9wLWNvbG9yPSIjYzgyMDJjIi8+PHN0b3Agb2Zmc2V0PSIuODQxIiBzdG9wLWNvbG9yPSIjYWUxZTI1Ii8+PHN0b3Agb2Zmc2V0PSIuOTQ0IiBzdG9wLWNvbG9yPSIjOGYxYTFkIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjN2ExODE4Ii8+PC9saW5lYXJHcmFkaWVudD48cGF0aCBmaWxsPSJ1cmwoI2IpIiBkPSJNMjggMzV2My45MjdjMCAzLjgwMy0zLjgyNCA2LjI0OS03LjAxOSA0LjQ5MWwtNi45MzYtNC40NDVjLS44MDItLjQ2Ni0xLjIzNi0xLjQ2Mi0uOTY0LTIuNDU3LjI1My0uOTI2IDEuMTIxLTEuNTE2IDIuMDM0LTEuNTE2SDI4eiIvPjxsaW5lYXJHcmFkaWVudCBpZD0iYyIgeDE9IjUuMzgyIiB4Mj0iMjUuODc0IiB5MT0iMzIuMjg5IiB5Mj0iMS43OCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2Q5NmFiMSIvPjxzdG9wIG9mZnNldD0iLjEzNyIgc3RvcC1jb2xvcj0iI2Q5NTM4YiIvPjxzdG9wIG9mZnNldD0iLjQ5NSIgc3RvcC1jb2xvcj0iI2Q5MWEyYSIvPjxzdG9wIG9mZnNldD0iLjU3NSIgc3RvcC1jb2xvcj0iI2QzMWEyOSIvPjxzdG9wIG9mZnNldD0iLjY4IiBzdG9wLWNvbG9yPSIjYzIxOTI2Ii8+PHN0b3Agb2Zmc2V0PSIuOCIgc3RvcC1jb2xvcj0iI2E3MTgyMSIvPjxzdG9wIG9mZnNldD0iLjkyOSIgc3RvcC1jb2xvcj0iIzgxMTYxOSIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzY5MTUxNSIvPjwvbGluZWFyR3JhZGllbnQ+PHBhdGggZmlsbD0idXJsKCNjKSIgZD0ibTIxLjk0NiA0LjUyNi0xMS45MjQgNi43ODZDOC43NzIgMTIuMDI0IDggMTMuMzUxIDggMTQuNzg5djE4LjQyOWMwIDEuMzU3IDEuNDU5IDIuMjE1IDIuNjQ1IDEuNTU0bDQuNDcyLTIuNDkxYy41NDUtLjMwMy44ODMtLjg3OS44ODMtMS41MDNWMTcuNzQzYzAtMS4zMDcuNzgtMi40OCAxLjk2My0yLjk0OUwyOCAxMS4zMDh2LTMuMDljMC0zLjIwNC0zLjMzMS01LjIzNS02LjA1NC0zLjY5MnoiLz48L3N2Zz4=);
        }
        .app > div.subscribe > aside.inner > .sub.sub--outlook-personal {
            padding-left: 40px;
            background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OCA0OCI+PHBhdGggZmlsbD0iIzEwMzI2MiIgZD0ibTQzLjI1NSAyMy41NDctNi44MS0zLjk2N3YxMS41OTRINDR2LTYuMzMxYzAtLjUzNC0uMjg0LTEuMDI3LS43NDUtMS4yOTZ6Ii8+PHBhdGggZmlsbD0iIzAwODRkNyIgZD0iTTEzIDEwaDEwdjlIMTN2LTl6Ii8+PHBhdGggZmlsbD0iIzMzYWZlYyIgZD0iTTIzIDEwaDEwdjlIMjN2LTl6Ii8+PHBhdGggZmlsbD0iIzU0ZGFmZiIgZD0iTTMzIDEwaDEwdjlIMzN2LTl6Ii8+PHBhdGggZmlsbD0iIzAyN2FkNCIgZD0iTTIzIDE5aDEwdjlIMjN2LTl6Ii8+PHBhdGggZmlsbD0iIzA1NTNhNCIgZD0iTTIzIDI4aDEwdjlIMjN2LTl6Ii8+PHBhdGggZmlsbD0iIzI1YTJlNSIgZD0iTTMzIDE5aDEwdjlIMzN2LTl6Ii8+PHBhdGggZmlsbD0iIzAyNjJiOCIgZD0iTTMzIDI4aDEwdjlIMzN2LTl6Ii8+PHBhdGggZD0iTTEzIDM3aDMwVjI0LjIzOGwtMTQuMDEgOC0xNS45OS04eiIgb3BhY2l0eT0iLjAxOSIvPjxwYXRoIGQ9Ik0xMyAzN2gzMFYyNC40NzZsLTE0LjAxIDgtMTUuOTktOHoiIG9wYWNpdHk9Ii4wMzgiLz48cGF0aCBkPSJNMTMgMzdoMzBWMjQuNzE0bC0xNC4wMSA4LTE1Ljk5LTh6IiBvcGFjaXR5PSIuMDU3Ii8+PHBhdGggZD0iTTEzIDM3aDMwVjI0Ljk1MmwtMTQuMDEgOC0xNS45OS04eiIgb3BhY2l0eT0iLjA3NiIvPjxwYXRoIGQ9Ik0xMyAzN2gzMFYyNS4xOWwtMTQuMDEgOC0xNS45OS04eiIgb3BhY2l0eT0iLjA5NSIvPjxwYXRoIGQ9Ik0xMyAzN2gzMFYyNS40MjlsLTE0LjAxIDgtMTUuOTktOHoiIG9wYWNpdHk9Ii4xMTQiLz48cGF0aCBkPSJNMTMgMzdoMzBWMjUuNjY3bC0xNC4wMSA4LTE1Ljk5LTh6IiBvcGFjaXR5PSIuMTMzIi8+PHBhdGggZD0iTTEzIDM3aDMwVjI1LjkwNWwtMTQuMDEgOC0xNS45OS04eiIgb3BhY2l0eT0iLjE1MiIvPjxwYXRoIGQ9Ik0xMyAzN2gzMFYyNi4xNDNsLTE0LjAxIDgtMTUuOTktOHoiIG9wYWNpdHk9Ii4xNzEiLz48cGF0aCBkPSJNMTMgMzdoMzBWMjYuMzgxbC0xNC4wMSA4LTE1Ljk5LTh6IiBvcGFjaXR5PSIuMTkxIi8+PHBhdGggZD0iTTEzIDM3aDMwVjI2LjYxOWwtMTQuMDEgOC0xNS45OS04eiIgb3BhY2l0eT0iLjIwOSIvPjxwYXRoIGQ9Ik0xMyAzN2gzMFYyNi44NTdsLTE0LjAxIDgtMTUuOTktOHoiIG9wYWNpdHk9Ii4yMjkiLz48cGF0aCBkPSJNMTMgMzdoMzB2LTkuOTA1bC0xNC4wMSA4LTE1Ljk5LTh6IiBvcGFjaXR5PSIuMjQ4Ii8+PHBhdGggZD0iTTEzIDM3aDMwdi05LjY2N2wtMTQuMDEgOC0xNS45OS04eiIgb3BhY2l0eT0iLjI2NyIvPjxwYXRoIGQ9Ik0xMyAzN2gzMHYtOS40MjlsLTE0LjAxIDgtMTUuOTktOHoiIG9wYWNpdHk9Ii4yODYiLz48cGF0aCBkPSJNMTMgMzdoMzB2LTkuMTlsLTE0LjAxIDgtMTUuOTktOHoiIG9wYWNpdHk9Ii4zMDUiLz48cGF0aCBkPSJNMTMgMzdoMzB2LTguOTUybC0xNC4wMSA4LTE1Ljk5LTh6IiBvcGFjaXR5PSIuMzI0Ii8+PHBhdGggZD0iTTEzIDM3aDMwdi04LjcxNGwtMTQuMDEgOC0xNS45OS04eiIgb3BhY2l0eT0iLjM0MyIvPjxwYXRoIGQ9Ik0xMyAzN2gzMHYtOC40NzZsLTE0LjAxIDgtMTUuOTktOHoiIG9wYWNpdHk9Ii4zNjIiLz48cGF0aCBkPSJNMTMgMzdoMzB2LTguMjM4bC0xNC4wMSA4LTE1Ljk5LTh6IiBvcGFjaXR5PSIuMzgxIi8+PHBhdGggZD0iTTEzIDM3aDMwdi04bC0xNC4wMSA4TDEzIDI5eiIgb3BhY2l0eT0iLjQiLz48bGluZWFyR3JhZGllbnQgaWQ9ImEiIHgxPSIzOC45MjUiIHgyPSIzMi4yODYiIHkxPSIyNC41NTciIHkyPSIzNi4wMjQiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiMzMWFiZWMiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiMxNTgyZDUiLz48L2xpbmVhckdyYWRpZW50PjxwYXRoIGZpbGw9InVybCgjYSkiIGQ9Ik0xNS40NDEgNDJoMjYuNTYzYzEuMTA0IDAgMS45OTktLjg4OSAyLTEuOTk0LjAwMy00LjUyMS0uMDA0LTE1LjE2My0uMDA0LTE1LjE2M3MtLjAwNy4yMjItMS43NTEgMS4yMTItMjcuNTA1IDE1LjUxMS0yNy41MDUgMTUuNTExLjIzNC40MzQuNjk3LjQzNHoiLz48bGluZWFyR3JhZGllbnQgaWQ9ImIiIHgxPSIxMy42NjUiIHgyPSI0MS4yODUiIHkxPSI2Ljk5MiIgeTI9IjkuMDc0IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHN0b3Agb2Zmc2V0PSIuMDQyIiBzdG9wLWNvbG9yPSIjMDc2ZGI0Ii8+PHN0b3Agb2Zmc2V0PSIuODUiIHN0b3AtY29sb3I9IiMwNDYxYWYiLz48L2xpbmVhckdyYWRpZW50PjxwYXRoIGZpbGw9InVybCgjYikiIGQ9Ik00MyAxMEgxM1Y4YzAtMS4xMDUuODk1LTIgMi0yaDI2YzEuMTA1IDAgMiAuODk1IDIgMnYyeiIvPjxsaW5lYXJHcmFkaWVudCBpZD0iYyIgeDE9IjI4LjE1MyIgeDI9IjIzLjYzOCIgeTE9IjMzLjIxOCIgeTI9IjQxLjEiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiMzM2FjZWUiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiMxYjhlZGYiLz48L2xpbmVhckdyYWRpZW50PjxwYXRoIGZpbGw9InVybCgjYykiIGQ9Ik0xMyAyNXYxNWMwIDEuMTA1Ljg5NSAyIDIgMkg0Mi4wMDRjLjQ2MiAwIC44ODMtLjE2MiAxLjIyMS0uNDI1TDEzIDI1eiIvPjxwYXRoIGQ9Ik0yMS4zMTkgMTNIMTN2MjRoOC4zMTlDMjMuMzUyIDM3IDI1IDM1LjM1MiAyNSAzMy4zMTlWMTYuNjgxQzI1IDE0LjY0OCAyMy4zNTIgMTMgMjEuMzE5IDEzeiIgb3BhY2l0eT0iLjA1Ii8+PHBhdGggZD0iTTIxLjIxMyAzNkgxM1YxMy4zMzNoOC4yMTNjMS43MjQgMCAzLjEyMSAxLjM5NyAzLjEyMSAzLjEyMXYxNi40MjVDMjQuMzMzIDM0LjYwMyAyMi45MzYgMzYgMjEuMjEzIDM2eiIgb3BhY2l0eT0iLjA3Ii8+PHBhdGggZD0iTTIxLjEwNiAzNUgxM1YxMy42NjdoOC4xMDZjMS40MTQgMCAyLjU2IDEuMTQ2IDIuNTYgMi41NlYzMi40NGMuMDAxIDEuNDE0LTEuMTQ2IDIuNTYtMi41NiAyLjU2eiIgb3BhY2l0eT0iLjA5Ii8+PGxpbmVhckdyYWRpZW50IGlkPSJkIiB4MT0iMy41MyIgeDI9IjIyLjQxIiB5MT0iMTQuNTMiIHkyPSIzMy40MSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iIzE3ODRkOCIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzA4NjRjNSIvPjwvbGluZWFyR3JhZGllbnQ+PHBhdGggZmlsbD0idXJsKCNkKSIgZD0iTTIxIDM0SDVjLTEuMTA1IDAtMi0uODk1LTItMlYxNmMwLTEuMTA1Ljg5NS0yIDItMmgxNmMxLjEwNSAwIDIgLjg5NSAyIDJ2MTZjMCAxLjEwNS0uODk1IDItMiAyeiIvPjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik0xMyAxOC42OTFjLTMuMTExIDAtNC45ODUgMi4zNzctNC45ODUgNS4zMDlTOS44ODIgMjkuMzA5IDEzIDI5LjMwOWMzLjExOSAwIDQuOTg1LTIuMzc3IDQuOTg1LTUuMzA4IDAtMi45MzMtMS44NzQtNS4zMS00Ljk4NS01LjMxem0wIDguODI2Yy0xLjc2NSAwLTIuODItMS41NzQtMi44Mi0zLjUxNnMxLjA2LTMuNTE2IDIuODItMy41MTYgMi44MjEgMS41NzUgMi44MjEgMy41MTYtMS4wNTcgMy41MTYtMi44MjEgMy41MTZ6Ii8+PC9zdmc+);
        }
        .app > div.subscribe > aside.inner > .sub.sub--outlook-local {
            padding-left: 40px;
            background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OCA0OCI+PGxpbmVhckdyYWRpZW50IGlkPSJhIiB4MT0iMjMuMDIiIHgyPSIyNS4wNjMiIHkxPSI0LjM2MiIgeTI9IjE4LjA0NCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPjxzdG9wIG9mZnNldD0iLjA0MiIgc3RvcC1jb2xvcj0iIzA3NmRiNCIvPjxzdG9wIG9mZnNldD0iLjg1IiBzdG9wLWNvbG9yPSIjMDQ2MWFmIi8+PC9saW5lYXJHcmFkaWVudD48cGF0aCBmaWxsPSJ1cmwoI2EpIiBkPSJNNDIgMTRINlY4YzAtMS4xMDUuODk1LTIgMi0yaDMyYzEuMTA1IDAgMiAuODk1IDIgMnY2eiIvPjxsaW5lYXJHcmFkaWVudCBpZD0iYiIgeDE9IjIxLjYzNSIgeDI9IjI3LjU2NyIgeTE9IjYuNDE3IiB5Mj0iNTguMTkzIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjMzNiZWYwIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjMGE4NWQ5Ii8+PC9saW5lYXJHcmFkaWVudD48cGF0aCBmaWxsPSJ1cmwoI2IpIiBkPSJNNiAxNHYyNmMwIDEuMTA1Ljg5NSAyIDIgMmgzMmMxLjEwNSAwIDItLjg5NSAyLTJWMTRINnoiLz48cGF0aCBmaWxsPSIjZmZmIiBkPSJNMjEgMjNoLTJjLS41NTIgMC0xLS40NDgtMS0xdi0yYzAtLjU1Mi40NDgtMSAxLTFoMmMuNTUyIDAgMSAuNDQ4IDEgMXYyYzAgLjU1Mi0uNDQ4IDEtMSAxek0yOSAyM2gtMmMtLjU1MiAwLTEtLjQ0OC0xLTF2LTJjMC0uNTUyLjQ0OC0xIDEtMWgyYy41NTIgMCAxIC40NDggMSAxdjJjMCAuNTUyLS40NDggMS0xIDF6TTM3IDIzaC0yYy0uNTUyIDAtMS0uNDQ4LTEtMXYtMmMwLS41NTIuNDQ4LTEgMS0xaDJjLjU1MiAwIDEgLjQ0OCAxIDF2MmMwIC41NTItLjQ0OCAxLTEgMXpNMjEgMzBoLTJjLS41NTIgMC0xLS40NDgtMS0xdi0yYzAtLjU1Mi40NDgtMSAxLTFoMmMuNTUyIDAgMSAuNDQ4IDEgMXYyYzAgLjU1Mi0uNDQ4IDEtMSAxek0xMyAzMGgtMmMtLjU1MiAwLTEtLjQ0OC0xLTF2LTJjMC0uNTUyLjQ0OC0xIDEtMWgyYy41NTIgMCAxIC40NDggMSAxdjJjMCAuNTUyLS40NDggMS0xIDF6TTI5IDMwaC0yYy0uNTUyIDAtMS0uNDQ4LTEtMXYtMmMwLS41NTIuNDQ4LTEgMS0xaDJjLjU1MiAwIDEgLjQ0OCAxIDF2MmMwIC41NTItLjQ0OCAxLTEgMXpNMjEgMzdoLTJjLS41NTIgMC0xLS40NDgtMS0xdi0yYzAtLjU1Mi40NDgtMSAxLTFoMmMuNTUyIDAgMSAuNDQ4IDEgMXYyYzAgLjU1Mi0uNDQ4IDEtMSAxek0xMyAzN2gtMmMtLjU1MiAwLTEtLjQ0OC0xLTF2LTJjMC0uNTUyLjQ0OC0xIDEtMWgyYy41NTIgMCAxIC40NDggMSAxdjJjMCAuNTUyLS40NDggMS0xIDF6TTI5IDM3aC0yYy0uNTUyIDAtMS0uNDQ4LTEtMXYtMmMwLS41NTIuNDQ4LTEgMS0xaDJjLjU1MiAwIDEgLjQ0OCAxIDF2MmMwIC41NTItLjQ0OCAxLTEgMXpNMzcgMzBoLTJjLS41NTIgMC0xLS40NDgtMS0xdi0yYzAtLjU1Mi40NDgtMSAxLTFoMmMuNTUyIDAgMSAuNDQ4IDEgMXYyYzAgLjU1Mi0uNDQ4IDEtMSAxeiIvPjxwYXRoIGQ9Ik0xNCA2djMuNWMwIC4yNzYtLjIyNS41LS41LjVzLS41LS4yMjQtLjUtLjVWNmgtMnYzLjVjMCAxLjM3OCAxLjEyMSAyLjUgMi41IDIuNVMxNiAxMC44NzggMTYgOS41VjZoLTJ6IiBvcGFjaXR5PSIuMDUiLz48cGF0aCBkPSJNMTQuNSA2djMuNWMwIC41NTEtLjQ0OCAxLTEgMXMtMS0uNDQ5LTEtMVY2aC0xdjMuNWMwIDEuMTAzLjg5NyAyIDIgMnMyLS44OTcgMi0yVjZoLTF6IiBvcGFjaXR5PSIuMDciLz48cGF0aCBkPSJNMzUgNnYzLjVjMCAuMjc2LS4yMjUuNS0uNS41cy0uNS0uMjI0LS41LS41VjZoLTJ2My41YzAgMS4zNzggMS4xMjEgMi41IDIuNSAyLjVTMzcgMTAuODc4IDM3IDkuNVY2aC0yeiIgb3BhY2l0eT0iLjA1Ii8+PHBhdGggZD0iTTM1LjUgNnYzLjVjMCAuNTUxLS40NDggMS0xIDFzLTEtLjQ0OS0xLTFWNmgtMXYzLjVjMCAxLjEwMy44OTcgMiAyIDJzMi0uODk3IDItMlY2aC0xeiIgb3BhY2l0eT0iLjA3Ii8+PHBhdGggZmlsbD0iIzU0ZGFmZiIgZD0iTTM0LjUgMTFjLS44MjggMC0xLjUtLjY3Mi0xLjUtMS41di01YzAtLjgyOC42NzItMS41IDEuNS0xLjVzMS41LjY3MiAxLjUgMS41djVjMCAuODI4LS42NzIgMS41LTEuNSAxLjV6TTEzLjUgMTFjLS44MjggMC0xLjUtLjY3Mi0xLjUtMS41di01YzAtLjgyOC42NzItMS41IDEuNS0xLjVzMS41LjY3MiAxLjUgMS41djVjMCAuODI4LS42NzIgMS41LTEuNSAxLjV6Ii8+PC9zdmc+);
        }
        .app > div.subscribe > aside.inner > .sub.sub--google {
            padding-left: 40px;
            background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OCA0OCI+PHBhdGggZmlsbD0iI2ZmZiIgZD0iTTEzIDEzaDIydjIySDEzeiIvPjxwYXRoIGZpbGw9IiMxZTg4ZTUiIGQ9Im0yNS42OCAyMC45MiAxLjAwOCAxLjQ0IDEuNTg0LTEuMTUydjguMzUySDMwVjE4LjYxNmgtMS40NHpNMjIuOTQzIDIzLjc0NWMuNjI1LS41NzQgMS4wMTMtMS4zNyAxLjAxMy0yLjI0OSAwLTEuNzQ3LTEuNTMzLTMuMTY4LTMuNDE3LTMuMTY4LTEuNjAyIDAtMi45NzIgMS4wMDktMy4zMyAyLjQ1M2wxLjY1Ny40MjFjLjE2NS0uNjY0Ljg2OC0xLjE0NiAxLjY3My0xLjE0Ni45NDIgMCAxLjcwOS42NDYgMS43MDkgMS40NCAwIC43OTQtLjc2NyAxLjQ0LTEuNzA5IDEuNDRoLS45OTd2MS43MjhoLjk5N2MxLjA4MSAwIDEuOTkzLjc1MSAxLjk5MyAxLjY0IDAgLjkwNC0uODY2IDEuNjQtMS45MzEgMS42NC0uOTYyIDAtMS43ODQtLjYxLTEuOTE0LTEuNDE4TDE3IDI2LjgwMmMuMjYyIDEuNjM2IDEuODEgMi44NyAzLjYgMi44NyAyLjAwNyAwIDMuNjQtMS41MTEgMy42NC0zLjM2OCAwLTEuMDIzLS41MDQtMS45NDEtMS4yOTctMi41NTl6Ii8+PHBhdGggZmlsbD0iI2ZiYzAyZCIgZD0iTTM0IDQySDE0bC0xLTQgMS00aDIwbDEgNHoiLz48cGF0aCBmaWxsPSIjNGNhZjUwIiBkPSJtMzggMzUgNC0xVjE0bC00LTEtNCAxdjIweiIvPjxwYXRoIGZpbGw9IiMxZTg4ZTUiIGQ9Im0zNCAxNCAxLTQtMS00SDlDNy4zNDMgNiA2IDcuMzQzIDYgOXYyNWw0IDEgNC0xVjE0aDIweiIvPjxwYXRoIGZpbGw9IiNlNTM5MzUiIGQ9Ik0zNCAzNHY4bDgtOHoiLz48cGF0aCBmaWxsPSIjMTU2NWMwIiBkPSJNMzkgNmgtNXY4aDhWOWMwLTEuNjU3LTEuMzQzLTMtMy0zek05IDQyaDV2LThINnY1YzAgMS42NTcgMS4zNDMgMyAzIDN6Ii8+PC9zdmc+);
        }
        .app > div.subscribe > aside.inner > .sub.sub--android {
            padding-left: 40px;
            background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OCA0OCI+PHBhdGggZmlsbD0iIzdjYjM0MiIgZD0iTTEyIDI5YzAgMS4xLS45IDItMiAycy0yLS45LTItMnYtOWMwLTEuMS45LTIgMi0yczIgLjkgMiAydjl6bTI4IDBjMCAxLjEtLjkgMi0yIDJzLTItLjktMi0ydi05YzAtMS4xLjktMiAyLTJzMiAuOSAyIDJ2OXpNMjIgNDBjMCAxLjEtLjkgMi0yIDJzLTItLjktMi0ydi05YzAtMS4xLjktMiAyLTJzMiAuOSAyIDJ2OXptOCAwYzAgMS4xLS45IDItMiAycy0yLS45LTItMnYtOWMwLTEuMS45LTIgMi0yczIgLjkgMiAydjl6Ii8+PHBhdGggZmlsbD0iIzdjYjM0MiIgZD0iTTE0IDE4djE1YzAgMS4xLjkgMiAyIDJoMTZjMS4xIDAgMi0uOSAyLTJWMThIMTR6TTI0IDhjLTYgMC05LjcgMy42LTEwIDhoMjBjLS4zLTQuNC00LTgtMTAtOHptLTQgNS42Yy0uNiAwLTEtLjQtMS0xcy40LTEgMS0xIDEgLjQgMSAxYzAgLjUtLjQgMS0xIDF6bTggMGMtLjYgMC0xLS40LTEtMXMuNC0xIDEtMSAxIC40IDEgMWMwIC41LS40IDEtMSAxeiIvPjxwYXRoIGZpbGw9IiM3Y2IzNDIiIGQ9Ik0yOC4zIDEwLjVjLS4yIDAtLjQtLjEtLjYtLjItLjUtLjMtLjYtLjktLjMtMS40bDEuNy0yLjVjLjMtLjUuOS0uNiAxLjQtLjMuNS4zLjYuOS4zIDEuNEwyOS4xIDEwYy0uMS4zLS40LjUtLjguNXptLTktLjRjLS4zIDAtLjctLjItLjgtLjVsLTEuMy0yLjFjLS4zLS41LS4yLTEuMS4zLTEuNC41LS4zIDEuMS0uMiAxLjQuM2wxLjMgMi4xYy4zLjUuMiAxLjEtLjMgMS40LS4yLjEtLjQuMi0uNi4yeiIvPjwvc3ZnPg==);
        }
        .app:not(.subscribe-visible) > div.subscribe {
            display: none;
        }
        @media screen and (max-width: 720px) {
            .app {
                grid-template-rows: min-content 1fr;
                grid-template-columns: 1fr;
                grid-template-areas: "toolbar" "main";
            }
            .app > nav.toolbar > button.options {
                display: block;
            }
            .app.options-expanded > nav.toolbar > button.options {
                background: var(--app-button-background-active);
            }
            .app > aside.options {
                grid-area: main;
                z-index: 100;
                background: var(--app-panel-background);
            }
            .app:not(.options-expanded) > aside.options {
                display: none;
            }
            .app > main {
                padding: 0 var(--app-spacing) var(--app-spacing) var(--app-spacing);
            }
        }
        @media screen and (prefers-color-scheme: dark) {
            html, body {
                background: #111;
                color: #eee;
            }
            .app {
                color: #eee;
                --app-panel-border: #333;
                --app-panel-background: #111;
                --app-panel-background-lighter: #222;
                --app-content-background: #000;
                --app-control-border: rgba(255, 255, 255, 0.25);
                --app-input-background: #444;
                --app-input-color: #fff;
                --app-button-color: #fff;
                --app-button-background: hsl(220, 100%, 30%);
                --app-button-background-hover: hsl(225, 67%, 23%);
                --app-button-background-active: hsl(230, 75%, 15%);
                --app-button-background-r: hsl(0, 100%, 30%);
                --app-button-background-r-hover: hsl(0, 67%, 23%);
                --app-button-background-r-active: hsl(0, 74%, 15%);
                --app-button-background-g: hsl(113, 100%, 30%);
                --app-button-background-g-hover: hsl(113, 67%, 23%);
                --app-button-background-g-active: hsl(113, 74%, 15%);
            }
            .app > main > section.calendar.fc {
                --fc-border-color: rgba(255, 255, 255, 0.2);
                --fc-neutral-bg-color: rgb(28, 28, 28);
                --fc-event-bg-color: rgba(28, 28, 28, 0.8);
                --fc-event-text-color: #eee;
                --fc-event-border-color: #333;
            }
            .app > div.subscribe {
                background: rgba(0, 0, 0, 0.80);
            }
        }
    </style>
</head>
<body>
    <div id="app" class="app">
        <nav class="toolbar">
            <img src="favicon.ico" width="32" height="32" alt="icon">
            <button class="options options">Options</button>
            <input type="text" class="query" autocomplete="off" autocapitalize="off" placeholder="Options...">
            <button class="primary subscribe">Subscribe</button>
        </nav>
        <aside class="options">
            <section data-opt="activity" data-opt-name="Activity" data-opt-type="filter" data-opt-example="*badminton" data-opt-doc="Case-insensitive activity name filter supporting wildcards."></section>
            <section data-opt="activity_id" data-opt-name="Activity ID" data-opt-type="filter" data-opt-example="00000000000000000000000000000000" data-opt-doc="Case-insensitive internal activity UUID filter."></section>
            <section data-opt="category" data-opt-name="Category" data-opt-type="filter" data-opt-example="lane swim schedules" data-opt-doc="Case-insensitive internal category name filter."></section>
            <section data-opt="category_id" data-opt-name="Category ID" data-opt-type="filter" data-opt-example="721" data-opt-doc="Numerical internal category ID filter."></section>
            <section data-opt="location" data-opt-name="Location" data-opt-type="filter" data-opt-example="*pool*" data-opt-doc="Case-insensitive location filter supporting wildcards."></section>
            <section data-opt="no_notifications" data-opt-name="Disable Notifications" data-opt-type="flag" data-opt-doc="Don't add global notifications as all-day events."></section>
            <section data-opt="fake_cancelled" data-opt-name="Fake Cancelled" data-opt-type="flag" data-opt-doc="Don't mark cancelled events as cancelled; just change the event title to include CANCELLED (this prevents cancelled events from disappearing on some calendar applications like Outlook and Apple Calendar)."></section>
            <section data-opt="delete_cancelled" data-opt-name="Delete Cancelled" data-opt-type="flag" data-opt-doc="Entirely delete cancelled events from the calendar (this can reduce clutter in some calendar applications)."></section>
            <section data-opt="describe_recurrence" data-opt-name="Describe Recurrence" data-opt-type="flag" data-opt-doc="Show detailed information about recurrences in the event descriptions."></section>
        </aside>
        <main>
            <section class="error" hidden></section>
            <section class="calendar"></section>
        </main>
        <div class="subscribe">
            <aside class="inner">
                <header>
                    <div class="title">Subscribe</div>
                    <button class="delete close">X</button>
                </header>
                <div class="sub" type="text">
                    <div class="name">Other</div>
                    <div class="desc">Copy and paste this link into your calendar application.</div>
                    <input type="text" autocomplete="off" autocapitalize="off" readonly="">
                </div>
                <a class="sub sub--google" target="_blank">
                    <div class="name">Google Calendar</div>
                    <div class="desc">Updates every 24+ hours.</div>
                </a>
                <a class="sub sub--outlook-work" target="_blank">
                    <div class="name">Office 365<span> (Outlook.com Work)</span></div>
                    <div class="desc">Updates every 3 hours.</div>
                </a>
                <a class="sub sub--outlook-personal" target="_blank">
                    <div class="name">Outlook.com<span> (Personal)</span></div>
                    <div class="desc">Updates every 3 hours.</div>
                </a>
                <a class="sub sub--outlook-local" target="_blank">
                    <div class="name">Outlook<span> (Windows)</span></div>
                    <div class="desc">Updates on launch and every 3 hours.</div>
                </a>
                <a class="sub sub--android" target="_blank">
                    <div class="name">Android<span> - ICSx5</span></div>
                    <div class="desc">Sync using the ICSx5 Android app.</div>
                </a>
                <a class="sub sub--apple" target="_blank">
                    <div class="name">Apple Calendar<span> - macOS/iOS/iPadOS</span></div>
                    <div class="desc">Updates on launch and every 1-3 hours.</div>
                </a>
            </aside>
        </div>
    </div>
    <script src="https://unpkg.com/@fullcalendar/core@6.1.9/index.global.min.js"></script>
    <script src="https://unpkg.com/@fullcalendar/list@6.1.9/index.global.min.js"></script>
    <script src="https://unpkg.com/@fullcalendar/daygrid@6.1.9/index.global.min.js"></script>
    <script src="https://unpkg.com/@fullcalendar/timegrid@6.1.9/index.global.min.js"></script>
    <script>
        try {
            function makeElement(element, attr, child) {
                if (!element) {
                    element = document.createDocumentFragment()
                } else if (typeof element === "string" || element instanceof String) {
                    element = document.createElement(element)
                }
                if (attr) {
                    for (const [k, v] of Object.entries(attr)) {
                        if (v !== undefined) {
                            if (!(typeof v === "string" || v instanceof String)) {
                                if (k.startsWith("on")) {
                                    element.addEventListener(k.substring(2), v)
                                    continue
                                } else if (k === "style" && typeof v === "object") {
                                    for (const [k, x] of Object.entries(v)) {
                                        element.style[k] = x
                                    }
                                    continue
                                } else if (v === true) {
                                    element.setAttribute(k, "")
                                }
                            }
                            element.setAttribute(k, v)
                        }
                    }
                }
                if (child) {
                    if (typeof child !== "array" && !(child instanceof Array)) {
                        child = [child]
                    }
                    for (const x of child) {
                        if (x) {
                            if (typeof x === "string" || x instanceof String) {
                                element.appendChild(document.createTextNode(x))
                            } else {
                                element.appendChild(x)
                            }
                        }
                    }
                }
                return element
            }

            class ParamOptions {
                #cb
                #vs
                constructor() {
                    this.#cb = []
                }
                parse(search) {
                    this.#vs = []
                    if (search.length) {
                        if (search.charAt(0) == "?") {
                            search = search.substring(1)
                        }
                        while (1) {
                            const i = search.indexOf("&")
                            let k = search
                            if (i != -1) {
                                k = k.substring(0, i)
                            }
                            let v
                            const j = k.indexOf("=")
                            if (j != -1) {
                                v = k.substring(j+1)
                                k = k.substring(0, j)
                            }
                            this.#vs.push(decodeURIComponent(k.replace(/\+/g, "%20")))
                            this.#vs.push(v ? decodeURIComponent(v.replace(/\+/g, "%20")) : undefined)
                            if (i == -1) {
                                break
                            }
                            search = search.substring(i+1)
                        }
                    }
                    this.#notify()
                }
                watch(cb, param = undefined) {
                    if (cb) {
                        this.#cb.push(param, cb)
                    }
                }
                getBool(key) {
                    let vi = -1
                    for (let i = 0; i < this.#vs.length; i += 2) {
                        if (this.#vs[i] == key) {
                            vi = i+1
                        }
                    }
                    if (vi === -1) {
                        return false
                    }
                    return [undefined, "1", "t", "T", "true", "TRUE", "True"].includes(this.#vs[vi])
                }
                get(key) {
                    const r = []
                    for (let i = 0; i < this.#vs.length; i += 2) {
                        if (this.#vs[i] == key) {
                            r.push(this.#vs[i+1])
                        }
                    }
                    return r
                }
                set(key, ...value) {
                    if (!value.length) {
                        value.push(undefined)
                    }
                    for (let i = 0; i < this.#vs.length;) {
                        if (this.#vs[i] == key) {
                            if (!value.length) {
                                this.#vs.splice(i, 2)
                                continue
                            }
                            this.#vs[i+1] = value.shift()
                        }
                        i += 2
                    }
                    for (const v of value) {
                        this.#vs.push(key, v)
                    }
                    this.#notify(key)
                }
                has(key, value = undefined) {
                    for (let i = 0; i < this.#vs.length; i += 2) {
                        if (this.#vs[i] == key && value == this.#vs[i+1]) {
                            return true
                        }
                    }
                    return false
                }
                add(key, value = undefined) {
                    this.#vs.push(key, value)
                    this.#notify(key)
                }
                remove(key, ...value) {
                    for (let i = 0; i < this.#vs.length;) {
                        if (this.#vs[i] == key && !value.length || value.includes(this.#vs[i+1])) {
                            this.#vs.splice(i, 2)
                            continue
                        }
                        i += 2
                    }
                    this.#notify(key)
                }
                toString() {
                    let r = ""
                    for (let i = 0; i < this.#vs.length; i += 2) {
                        if (r.length) {
                            r += "&"
                        }
                        r += encodeURIComponent(this.#vs[i]).replace(/\+/g, "%2B").replace(/%20/g, "+")
                        if (this.#vs[i+1] !== undefined) {
                            r += "="
                            r += encodeURIComponent(this.#vs[i+1]).replace(/\+/g, "%2B").replace(/%20/g, "+")
                        }
                    }
                    return r
                }
                #notify(key = undefined) {
                    for (let i = 0; i < this.#cb.length; i += 2) {
                        if (key === undefined || this.#cb[i] === undefined || this.#cb[i] == key) {
                            this.#cb[i+1]()
                        }
                    }
                }
            }

            const app = document.getElementById("app")
            
            // query string handling
            const qpo = new ParamOptions()
            const query = app.querySelector("nav.toolbar > input.query")
            qpo.watch(() => {
                const u = new URL(window.location.href)
                query.value = u.search = qpo.toString()
                window.history.replaceState(null, "", u)
            })

            let debounce
            query.addEventListener("input", () => {
                if (debounce !== undefined) {
                    window.clearTimeout(debounce)
                }
                debounce = window.setTimeout(() => qpo.parse(query.value), 150)
            })

            // options
            for (const el of app.querySelectorAll("aside.options > section[data-opt]")) {
                const opt = {
                    query: el.dataset.opt,
                    name: el.dataset.optName ?? el.dataset.opt,
                    type: el.dataset.optType ?? "flag",
                    example: el.dataset.optExample ?? null,
                    doc: el.dataset.optDoc ?? null,
                }
                el.classList.add(`opt--${opt.type}`)

                const frag = document.createDocumentFragment()
                switch (opt.type) {
                case "filter":
                    let el_items, el_item_input
                    frag.appendChild(makeElement("div", { class: "opt__name" }, `${opt.name}`))
                    opt.doc && frag.appendChild(makeElement("div", { class: "opt__doc" }, `${opt.doc}`))
                    el_items = frag.appendChild(makeElement("div", { class: "opt_items" }))
                    qpo.watch(() => {
                        const frag = document.createDocumentFragment()
                        frag.appendChild(makeElement("div", { class: "opt__item opt__item--new" }, [
                            el_item_input = makeElement("input", {
                                autocomplete: "off",
                                autocapitalize: "off",
                                placeholder: opt.example ? `${opt.example}` : undefined,
                                onkeydown(ev) {
                                    if (ev.keyCode == 13) {
                                        let flt = el_item_input.value.trim()
                                        if (flt.length) {
                                            if (!qpo.has(opt.query, flt)) {
                                                qpo.add(opt.query, flt)
                                            }
                                            el_item_input.value = ""
                                        }
                                    }
                                },
                            }),
                            makeElement("button", {
                                class: "primary",
                                title: "Include",
                                onclick() {
                                    let flt = el_item_input.value.trim().replace(/^-/, "")
                                    if (flt.length) {
                                        if (!qpo.has(opt.query, flt)) {
                                            qpo.add(opt.query, flt)
                                        }
                                        el_item_input.value = ""
                                    }
                                },
                            }, "+"),
                            makeElement("button", {
                                title: "Exclude",
                                onclick() {
                                    let flt = el_item_input.value.trim().replace(/^-/, "")
                                    if (flt.length) {
                                        flt = "-" + flt
                                        if (!qpo.has(opt.query, flt)) {
                                            qpo.add(opt.query, flt)
                                        }
                                        el_item_input.value = ""
                                    }
                                },
                            }, "-"),
                        ]))
                        for (const item of qpo.get(opt.query)) {
                            frag.appendChild(makeElement("div", { class: "opt__item" }, [
                                makeElement("input", {
                                    value: item,
                                    disabled: true,
                                    autocomplete: "off",
                                    autocapitalize: "off",
                                }),
                                makeElement("button", {
                                    class: "delete",
                                    onclick() {
                                        qpo.remove(opt.query, item)
                                    },
                                }, "x")
                            ]))
                        }
                        el_items.replaceChildren(frag)
                    }, opt.query)
                    break
                case "flag":
                    let el_cb
                    frag.appendChild(makeElement("label", { for: `val_${opt.query}` }, [
                        el_cb = frag.appendChild(makeElement("input", {
                            id: `val_${opt.query}`,
                            autocomplete: "off",
                            type: "checkbox",
                            name: `${opt.query}`,
                            oninput() {
                                if (el_cb.checked) {
                                    qpo.set(opt.query)
                                } else {
                                    qpo.remove(opt.query)
                                }
                            }
                        })),
                        makeElement("div", null, [
                            opt.doc && makeElement("div", { class: "opt__name" }, opt.name),
                            opt.doc && makeElement("div", { class: "opt__doc" }, opt.doc),
                        ]),
                    ]))
                    qpo.watch(() => {
                        el_cb.checked = qpo.getBool(opt.query)
                    }, opt.query)
                    break
                default:
                    throw new TypeError(`Invalid option type ${opt.type} for option ${opt.query}`)
                }
                el.appendChild(frag)
            }

            const calURL = ext => {
                const url = new URL(window.location)
                url.hash = ""
                url.pathname = url.pathname.replace(/\.html$/, "") + "." + ext
                return url.toString()
            }

            const btn_opts = app.querySelector("nav.toolbar > button.options")
            btn_opts.addEventListener("click", () => {
                app.classList.toggle("options-expanded")
            })

            const sub_fallback = app.querySelector("div.subscribe div.sub input")
            const sub_google = app.querySelector("div.subscribe a.sub--google")
            const sub_apple = app.querySelector("div.subscribe a.sub--apple")
            const sub_outlook_work = app.querySelector("div.subscribe a.sub--outlook-work")
            const sub_outlook_personal = app.querySelector("div.subscribe a.sub--outlook-personal")
            const sub_outlook_local = app.querySelector("div.subscribe a.sub--outlook-local")
            const sub_android = app.querySelector("div.subscribe a.sub--android")
            qpo.watch(() => {
                const u = new URL(calURL("ics"))
                const u_http = u.toString()
                const u_http_enc = encodeURIComponent(u_http).replace(/\+/g, "%2B").replace(/%20/g, "+")
                u.protocol = "http"
                const u_httpi = u.toString()
                const u_httpi_enc = encodeURIComponent(u_httpi).replace(/\+/g, "%2B").replace(/%20/g, "+")
                u.protocol = "webcal"
                const u_webcal = u.toString()
                sub_fallback.value = u_http
                sub_google.href = `https://calendar.google.com/calendar/u/0/r?cid=${u_httpi_enc}&pli=1`
                sub_apple.href = u_webcal
                sub_outlook_work.href = `https://outlook.office.com/calendar/0/addfromweb?url=${u_http_enc}&name=Calendar&mkt=en-001`
                sub_outlook_personal.href = `https://outlook.live.com/calendar/0/addfromweb?url=${u_http_enc}&name=Calendar&mkt=en-001`
                sub_outlook_local.href = u_webcal
                sub_android.href = u_webcal
            })
            sub_fallback.addEventListener("focus", () => {
                sub_fallback.select()
            })

            const btn_ics = app.querySelector("nav.toolbar > button.subscribe")
            const btn_sub_close = app.querySelector("div.subscribe button.close")
            btn_ics.addEventListener("click", () => {
                app.classList.add("subscribe-visible")
                sub_fallback.focus()
                sub_fallback.select()
            })
            btn_sub_close.addEventListener("click", () => {
                app.classList.remove("subscribe-visible")
            })

            const viewTypes = ["listWeek", "timeGridWeek", "timeGridThreeDay"]
            const viewKeys = ["list", "week", "3day"]
            const calendar = new FullCalendar.Calendar(app.querySelector("main > section.calendar"), {
                initialView: viewTypes[Math.max(0, viewKeys.indexOf(new URLSearchParams(window.location.hash.substring(1)).get("view")))],
                height: "100%",
                headerToolbar: {
                    left: "prev,next",
                    center: "title",
                    right: viewTypes.join(","),
                },
                views: {
                    timeGridThreeDay: {
                        type: "timeGridWeek",
                        duration: { days: 3 },
                        buttonText: "3-day",
                    },
                },
                viewClassNames(arg) {
                    const url = new URL(window.location.href)
                    const p = new URLSearchParams(url.hash.substring(1))
                    p.set("view", viewKeys[viewTypes.indexOf(arg.view.type)])
                    url.hash = p.toString()
                    window.history.replaceState(null, "", url)
                },
                eventContent(arg) {
                    return {
                        domNodes: [
                            // note: FullCalendar has a bug where if we pass it
                            // a fragment in the array, it won't clean up the
                            // elements properly when updating a rendered event
                            // (e.g., when switching between timeGridWeek and
                            // timeGridThreeDay)
                            ...makeElement(null, null, [
                                arg.event.title && makeElement("b", {
                                    style: {
                                        textDecoration: arg.event.extendedProps.isCancelled ? "line-through" : "none",
                                    },
                                }, arg.event.title),
                                arg.event.extendedProps?.location?.length && arg.view.type !== "listWeek" && makeElement("br"),
                                arg.event.extendedProps?.location?.length && arg.view.type === "listWeek" && makeElement("span", null, " \u00b7 "),
                                arg.event.extendedProps?.location?.length && makeElement("span", null, arg.event.extendedProps.location),
                                arg.event.extendedProps?.description?.length && arg.view.type !== "listWeek" && makeElement("br"),
                                arg.event.extendedProps?.description?.length && arg.view.type === "listWeek" && makeElement("span", null, " \u00b7 "),
                                arg.event.extendedProps?.description?.length && makeElement("span", {
                                    style: {
                                        whiteSpace: "pre-wrap",
                                    },
                                }, arg.event.extendedProps.description),
                                arg.event.extendedProps?.isRecurrence && arg.view.type !== "listWeek" && makeElement(
                                    document.createElementNS("http://www.w3.org/2000/svg", "svg"), {
                                        viewBox: "0 0 24 24",
                                        width: "14",
                                        height: "14",
                                        style: {
                                            position: "absolute",
                                            bottom: "1px",
                                            right: "1px",
                                        },
                                    },
                                    makeElement(document.createElementNS("http://www.w3.org/2000/svg", "path"), {
                                        fill: "currentColor",
                                        d: arg.event.extendedProps.isException // icon from fluenticons.co
                                            ? "m3.613 2.21.094.083 18 18a1 1 0 0 1-1.32 1.497l-.094-.083-3.068-3.068c-.599.2-1.234.322-1.893.353l-.331.008H9.405l1.304 1.303.077.087A1 1 0 0 1 9.39 21.8l-.095-.083-3.005-3.005-.077-.087a1 1 0 0 1-.006-1.232l.083-.095 3.005-3.005.088-.078a1 1 0 0 1 1.232-.006l.095.084.077.087a1 1 0 0 1 .006 1.232l-.083.095-1.294 1.292h5.586c.187 0 .372-.01.553-.03L6.348 7.761A4.996 4.996 0 0 0 4 12.001c0 .918.248 1.779.68 2.519l.135.218a1 1 0 0 1-1.627 1.164A6.952 6.952 0 0 1 2 12a6.99 6.99 0 0 1 2.908-5.679L2.293 3.707a1 1 0 0 1 1.32-1.498ZM20 7.681c.32 0 .603.15.787.382l.053.075.017.027A6.963 6.963 0 0 1 22 12.001c0 1.977-.82 3.762-2.138 5.035l-1.415-1.414A4.985 4.985 0 0 0 20 12.001c0-.926-.252-1.793-.69-2.537l-.138-.22A1 1 0 0 1 20 7.683Zm-5.375-5.47.087.077 3.006 3.005a1 1 0 0 1 .077 1.327l-.078.087-3.005 3.006a1 1 0 0 1-1.492-1.327l.078-.088 1.297-1.298H9.826L7.911 5.085c.278-.043.56-.07.848-.08l.24-.004h5.598l-1.299-1.298a1 1 0 0 1-.078-1.327l.078-.087a1 1 0 0 1 1.327-.078Z"
                                            : "m14.712 2.289-.087-.078a1 1 0 0 0-1.327.078l-.078.087a.999.999 0 0 0 .078 1.326l1.299 1.297H8.999l-.24.004A6.997 6.997 0 0 0 2 11.993c0 1.445.438 2.788 1.189 3.899a.999.999 0 0 0 1.626-1.163l-.135-.218A4.997 4.997 0 0 1 9 6.998h5.595l-1.297 1.297-.078.087a.999.999 0 0 0 1.492 1.326l3.006-3.003.077-.087a.999.999 0 0 0-.078-1.326l-3.005-3.003Zm6.075 5.771A.999.999 0 0 0 19 8.677c0 .209.064.402.172.561a4.997 4.997 0 0 1-4.17 7.75H9.414l1.294-1.29.083-.096a1 1 0 0 0-.006-1.23l-.077-.088-.095-.084a1.001 1.001 0 0 0-1.232.006l-.088.078-3.005 3.003-.083.095a1 1 0 0 0 .006 1.231l.077.087 3.005 3.003.095.084a1 1 0 0 0 1.397-1.41l-.077-.087-1.304-1.303h5.596l.24-.003a6.997 6.997 0 0 0 5.546-10.927v.003Z",
                                    }),
                                ),
                            ]).children,
                        ],
                    }
                }
            })
            window.addEventListener("hashchange", ev => {
                const i = viewKeys.indexOf(new URLSearchParams(window.location.hash.substring(1)).get("view"))
                if (i != -1) {
                    calendar.changeView(viewTypes[i])
                }
            })
            calendar.render()

            const fetchCalendar = async (url, signal) => {
                const resp = await fetch(url, { signal })
                if (resp.status != 200) {
                    let err = new Error(`Response status ${resp.status} (${resp.statusText})`)
                    try {
                        err = new Error(await resp.text())
                    } catch (ex) {
                        console.warn(ex)
                    }
                    console.warn(err)
                    throw err
                }
                return await resp.json()
            }

            const errorEl = document.querySelector("#app > main > section.error")

            let controller
            qpo.watch(() => {
                if (controller !== undefined) {
                    controller.abort()
                }
                let thisController = new AbortController()
                controller = thisController

                calendar.getEventSources().forEach(x => x.remove())
                fetchCalendar(calURL("fc.json"), controller.signal).then(
                    events => {
                        if (!thisController.signal.aborted) {
                            calendar.addEventSource({ events })
                            errorEl.hidden = true
                            errorEl.textContent = ""
                        }
                    },
                    err => {
                        if (!thisController.signal.aborted) {
                            errorEl.hidden = false
                            errorEl.textContent = `${err}`
                        }
                    },
                )
            })

            qpo.parse(window.location.search)
        } catch (ex) {
            const errorEl = document.querySelector("#app > main > section.error")
            errorEl.hidden = false
            errorEl.textContent = `${ex}`
        }
    </script>
</body>
</html>
